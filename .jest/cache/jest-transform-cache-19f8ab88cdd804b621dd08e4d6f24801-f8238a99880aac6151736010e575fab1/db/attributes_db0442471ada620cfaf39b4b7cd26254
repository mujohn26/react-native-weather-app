8daf799183c9d7771e2866140199cdaa
var $ = require("../static"),
    utils = require("../utils"),
    isTag = utils.isTag,
    domEach = utils.domEach,
    hasOwn = Object.prototype.hasOwnProperty,
    camelCase = utils.camelCase,
    cssCase = utils.cssCase,
    rspace = /\s+/,
    dataAttrPrefix = 'data-',
    _ = {
  forEach: require('lodash/forEach'),
  extend: require('lodash/assignIn'),
  some: require('lodash/some')
},
    primitives = {
  null: null,
  true: true,
  false: false
},
    rboolean = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
    rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/;

var getAttr = function getAttr(elem, name) {
  if (!elem || !isTag(elem)) return;

  if (!elem.attribs) {
    elem.attribs = {};
  }

  if (!name) {
    return elem.attribs;
  }

  if (hasOwn.call(elem.attribs, name)) {
    return rboolean.test(name) ? name : elem.attribs[name];
  }

  if (elem.name === 'option' && name === 'value') {
    return $.text(elem.children);
  }

  if (elem.name === 'input' && (elem.attribs.type === 'radio' || elem.attribs.type === 'checkbox') && name === 'value') {
    return 'on';
  }
};

var setAttr = function setAttr(el, name, value) {
  if (value === null) {
    removeAttribute(el, name);
  } else {
    el.attribs[name] = value + '';
  }
};

exports.attr = function (name, value) {
  if (typeof name === 'object' || value !== undefined) {
    if (typeof value === 'function') {
      return domEach(this, function (i, el) {
        setAttr(el, name, value.call(el, i, el.attribs[name]));
      });
    }

    return domEach(this, function (i, el) {
      if (!isTag(el)) return;

      if (typeof name === 'object') {
        _.forEach(name, function (objValue, objName) {
          setAttr(el, objName, objValue);
        });
      } else {
        setAttr(el, name, value);
      }
    });
  }

  return getAttr(this[0], name);
};

var getProp = function getProp(el, name) {
  if (!el || !isTag(el)) return;
  return hasOwn.call(el, name) ? el[name] : rboolean.test(name) ? getAttr(el, name) !== undefined : getAttr(el, name);
};

var setProp = function setProp(el, name, value) {
  el[name] = rboolean.test(name) ? !!value : value;
};

exports.prop = function (name, value) {
  var i = 0,
      property;

  if (typeof name === 'string' && value === undefined) {
    switch (name) {
      case 'style':
        property = this.css();

        _.forEach(property, function (v, p) {
          property[i++] = p;
        });

        property.length = i;
        break;

      case 'tagName':
      case 'nodeName':
        property = this[0].name.toUpperCase();
        break;

      default:
        property = getProp(this[0], name);
    }

    return property;
  }

  if (typeof name === 'object' || value !== undefined) {
    if (typeof value === 'function') {
      return domEach(this, function (j, el) {
        setProp(el, name, value.call(el, j, getProp(el, name)));
      });
    }

    return domEach(this, function (__, el) {
      if (!isTag(el)) return;

      if (typeof name === 'object') {
        _.forEach(name, function (val, key) {
          setProp(el, key, val);
        });
      } else {
        setProp(el, name, value);
      }
    });
  }
};

var setData = function setData(el, name, value) {
  if (!el.data) {
    el.data = {};
  }

  if (typeof name === 'object') return _.extend(el.data, name);

  if (typeof name === 'string' && value !== undefined) {
    el.data[name] = value;
  }
};

var readData = function readData(el, name) {
  var readAll = arguments.length === 1;
  var domNames, domName, jsNames, jsName, value, idx, length;

  if (readAll) {
    domNames = Object.keys(el.attribs).filter(function (attrName) {
      return attrName.slice(0, dataAttrPrefix.length) === dataAttrPrefix;
    });
    jsNames = domNames.map(function (_domName) {
      return camelCase(_domName.slice(dataAttrPrefix.length));
    });
  } else {
    domNames = [dataAttrPrefix + cssCase(name)];
    jsNames = [name];
  }

  for (idx = 0, length = domNames.length; idx < length; ++idx) {
    domName = domNames[idx];
    jsName = jsNames[idx];

    if (hasOwn.call(el.attribs, domName)) {
      value = el.attribs[domName];

      if (hasOwn.call(primitives, value)) {
        value = primitives[value];
      } else if (value === String(Number(value))) {
        value = Number(value);
      } else if (rbrace.test(value)) {
        try {
          value = JSON.parse(value);
        } catch (e) {}
      }

      el.data[jsName] = value;
    }
  }

  return readAll ? el.data : value;
};

exports.data = function (name, value) {
  var elem = this[0];
  if (!elem || !isTag(elem)) return;

  if (!elem.data) {
    elem.data = {};
  }

  if (!name) {
    return readData(elem);
  }

  if (typeof name === 'object' || value !== undefined) {
    domEach(this, function (i, el) {
      setData(el, name, value);
    });
    return this;
  } else if (hasOwn.call(elem.data, name)) {
    return elem.data[name];
  }

  return readData(elem, name);
};

exports.val = function (value) {
  var querying = arguments.length === 0,
      element = this[0];
  if (!element) return;

  switch (element.name) {
    case 'textarea':
      return this.text(value);

    case 'input':
      switch (this.attr('type')) {
        case 'radio':
          if (querying) {
            return this.attr('value');
          } else {
            this.attr('value', value);
            return this;
          }

          break;

        default:
          return this.attr('value', value);
      }

      return;

    case 'select':
      var option = this.find('option:selected'),
          returnValue;
      if (option === undefined) return undefined;

      if (!querying) {
        if (!hasOwn.call(this.attr(), 'multiple') && typeof value == 'object') {
          return this;
        }

        if (typeof value != 'object') {
          value = [value];
        }

        this.find('option').removeAttr('selected');

        for (var i = 0; i < value.length; i++) {
          this.find('option[value="' + value[i] + '"]').attr('selected', '');
        }

        return this;
      }

      returnValue = option.attr('value');

      if (hasOwn.call(this.attr(), 'multiple')) {
        returnValue = [];
        domEach(option, function (__, el) {
          returnValue.push(getAttr(el, 'value'));
        });
      }

      return returnValue;

    case 'option':
      if (!querying) {
        this.attr('value', value);
        return this;
      }

      return this.attr('value');
  }
};

var removeAttribute = function removeAttribute(elem, name) {
  if (!elem.attribs || !hasOwn.call(elem.attribs, name)) return;
  delete elem.attribs[name];
};

exports.removeAttr = function (name) {
  domEach(this, function (i, elem) {
    removeAttribute(elem, name);
  });
  return this;
};

exports.hasClass = function (className) {
  return _.some(this, function (elem) {
    var attrs = elem.attribs,
        clazz = attrs && attrs['class'],
        idx = -1,
        end;

    if (clazz && className.length) {
      while ((idx = clazz.indexOf(className, idx + 1)) > -1) {
        end = idx + className.length;

        if ((idx === 0 || rspace.test(clazz[idx - 1])) && (end === clazz.length || rspace.test(clazz[end]))) {
          return true;
        }
      }
    }
  });
};

exports.addClass = function (value) {
  if (typeof value === 'function') {
    return domEach(this, function (i, el) {
      var className = el.attribs['class'] || '';
      exports.addClass.call([el], value.call(el, i, className));
    });
  }

  if (!value || typeof value !== 'string') return this;
  var classNames = value.split(rspace),
      numElements = this.length;

  for (var i = 0; i < numElements; i++) {
    if (!isTag(this[i])) continue;
    var className = getAttr(this[i], 'class'),
        numClasses,
        setClass;

    if (!className) {
      setAttr(this[i], 'class', classNames.join(' ').trim());
    } else {
      setClass = ' ' + className + ' ';
      numClasses = classNames.length;

      for (var j = 0; j < numClasses; j++) {
        var appendClass = classNames[j] + ' ';
        if (setClass.indexOf(' ' + appendClass) < 0) setClass += appendClass;
      }

      setAttr(this[i], 'class', setClass.trim());
    }
  }

  return this;
};

var splitClass = function splitClass(className) {
  return className ? className.trim().split(rspace) : [];
};

exports.removeClass = function (value) {
  var classes, numClasses, removeAll;

  if (typeof value === 'function') {
    return domEach(this, function (i, el) {
      exports.removeClass.call([el], value.call(el, i, el.attribs['class'] || ''));
    });
  }

  classes = splitClass(value);
  numClasses = classes.length;
  removeAll = arguments.length === 0;
  return domEach(this, function (i, el) {
    if (!isTag(el)) return;

    if (removeAll) {
      el.attribs.class = '';
    } else {
      var elClasses = splitClass(el.attribs.class),
          index,
          changed;

      for (var j = 0; j < numClasses; j++) {
        index = elClasses.indexOf(classes[j]);

        if (index >= 0) {
          elClasses.splice(index, 1);
          changed = true;
          j--;
        }
      }

      if (changed) {
        el.attribs.class = elClasses.join(' ');
      }
    }
  });
};

exports.toggleClass = function (value, stateVal) {
  if (typeof value === 'function') {
    return domEach(this, function (i, el) {
      exports.toggleClass.call([el], value.call(el, i, el.attribs['class'] || '', stateVal), stateVal);
    });
  }

  if (!value || typeof value !== 'string') return this;
  var classNames = value.split(rspace),
      numClasses = classNames.length,
      state = typeof stateVal === 'boolean' ? stateVal ? 1 : -1 : 0,
      numElements = this.length,
      elementClasses,
      index;

  for (var i = 0; i < numElements; i++) {
    if (!isTag(this[i])) continue;
    elementClasses = splitClass(this[i].attribs.class);

    for (var j = 0; j < numClasses; j++) {
      index = elementClasses.indexOf(classNames[j]);

      if (state >= 0 && index < 0) {
        elementClasses.push(classNames[j]);
      } else if (state <= 0 && index >= 0) {
        elementClasses.splice(index, 1);
      }
    }

    this[i].attribs.class = elementClasses.join(' ');
  }

  return this;
};

exports.is = function (selector) {
  if (selector) {
    return this.filter(selector).length > 0;
  }

  return false;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF0dHJpYnV0ZXMuanMiXSwibmFtZXMiOlsiJCIsInJlcXVpcmUiLCJ1dGlscyIsImlzVGFnIiwiZG9tRWFjaCIsImhhc093biIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FtZWxDYXNlIiwiY3NzQ2FzZSIsInJzcGFjZSIsImRhdGFBdHRyUHJlZml4IiwiXyIsImZvckVhY2giLCJleHRlbmQiLCJzb21lIiwicHJpbWl0aXZlcyIsIm51bGwiLCJ0cnVlIiwiZmFsc2UiLCJyYm9vbGVhbiIsInJicmFjZSIsImdldEF0dHIiLCJlbGVtIiwibmFtZSIsImF0dHJpYnMiLCJjYWxsIiwidGVzdCIsInRleHQiLCJjaGlsZHJlbiIsInR5cGUiLCJzZXRBdHRyIiwiZWwiLCJ2YWx1ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImV4cG9ydHMiLCJhdHRyIiwidW5kZWZpbmVkIiwiaSIsIm9ialZhbHVlIiwib2JqTmFtZSIsImdldFByb3AiLCJzZXRQcm9wIiwicHJvcCIsInByb3BlcnR5IiwiY3NzIiwidiIsInAiLCJsZW5ndGgiLCJ0b1VwcGVyQ2FzZSIsImoiLCJfXyIsInZhbCIsImtleSIsInNldERhdGEiLCJkYXRhIiwicmVhZERhdGEiLCJyZWFkQWxsIiwiYXJndW1lbnRzIiwiZG9tTmFtZXMiLCJkb21OYW1lIiwianNOYW1lcyIsImpzTmFtZSIsImlkeCIsImtleXMiLCJmaWx0ZXIiLCJhdHRyTmFtZSIsInNsaWNlIiwibWFwIiwiX2RvbU5hbWUiLCJTdHJpbmciLCJOdW1iZXIiLCJKU09OIiwicGFyc2UiLCJlIiwicXVlcnlpbmciLCJlbGVtZW50Iiwib3B0aW9uIiwiZmluZCIsInJldHVyblZhbHVlIiwicmVtb3ZlQXR0ciIsInB1c2giLCJoYXNDbGFzcyIsImNsYXNzTmFtZSIsImF0dHJzIiwiY2xhenoiLCJlbmQiLCJpbmRleE9mIiwiYWRkQ2xhc3MiLCJjbGFzc05hbWVzIiwic3BsaXQiLCJudW1FbGVtZW50cyIsIm51bUNsYXNzZXMiLCJzZXRDbGFzcyIsImpvaW4iLCJ0cmltIiwiYXBwZW5kQ2xhc3MiLCJzcGxpdENsYXNzIiwicmVtb3ZlQ2xhc3MiLCJjbGFzc2VzIiwicmVtb3ZlQWxsIiwiY2xhc3MiLCJlbENsYXNzZXMiLCJpbmRleCIsImNoYW5nZWQiLCJzcGxpY2UiLCJ0b2dnbGVDbGFzcyIsInN0YXRlVmFsIiwic3RhdGUiLCJlbGVtZW50Q2xhc3NlcyIsImlzIiwic2VsZWN0b3IiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLENBQUMsR0FBR0MsT0FBTyxhQUFmO0FBQUEsSUFDSUMsS0FBSyxHQUFHRCxPQUFPLFlBRG5CO0FBQUEsSUFFSUUsS0FBSyxHQUFHRCxLQUFLLENBQUNDLEtBRmxCO0FBQUEsSUFHSUMsT0FBTyxHQUFHRixLQUFLLENBQUNFLE9BSHBCO0FBQUEsSUFJSUMsTUFBTSxHQUFHQyxNQUFNLENBQUNDLFNBQVAsQ0FBaUJDLGNBSjlCO0FBQUEsSUFLSUMsU0FBUyxHQUFHUCxLQUFLLENBQUNPLFNBTHRCO0FBQUEsSUFNSUMsT0FBTyxHQUFHUixLQUFLLENBQUNRLE9BTnBCO0FBQUEsSUFPSUMsTUFBTSxHQUFHLEtBUGI7QUFBQSxJQVFJQyxjQUFjLEdBQUcsT0FSckI7QUFBQSxJQVNJQyxDQUFDLEdBQUc7QUFDRkMsRUFBQUEsT0FBTyxFQUFFYixPQUFPLENBQUMsZ0JBQUQsQ0FEZDtBQUVGYyxFQUFBQSxNQUFNLEVBQUVkLE9BQU8sQ0FBQyxpQkFBRCxDQUZiO0FBR0ZlLEVBQUFBLElBQUksRUFBRWYsT0FBTyxDQUFDLGFBQUQ7QUFIWCxDQVRSO0FBQUEsSUFpQkVnQixVQUFVLEdBQUc7QUFDWEMsRUFBQUEsSUFBSSxFQUFFLElBREs7QUFFWEMsRUFBQUEsSUFBSSxFQUFFLElBRks7QUFHWEMsRUFBQUEsS0FBSyxFQUFFO0FBSEksQ0FqQmY7QUFBQSxJQXdCRUMsUUFBUSxHQUFHLDZIQXhCYjtBQUFBLElBMEJFQyxNQUFNLEdBQUcsK0JBMUJYOztBQTZCQSxJQUFJQyxPQUFPLEdBQUcsU0FBVkEsT0FB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dEM7QUFDRDs7QUFDRCxTQUFPLEtBQVA7QUFDRCxDQUxEIiwic291cmNlc0NvbnRlbnQiOlsidmFyICQgPSByZXF1aXJlKCcuLi9zdGF0aWMnKSxcbiAgICB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyksXG4gICAgaXNUYWcgPSB1dGlscy5pc1RhZyxcbiAgICBkb21FYWNoID0gdXRpbHMuZG9tRWFjaCxcbiAgICBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFxuICAgIGNhbWVsQ2FzZSA9IHV0aWxzLmNhbWVsQ2FzZSxcbiAgICBjc3NDYXNlID0gdXRpbHMuY3NzQ2FzZSxcbiAgICByc3BhY2UgPSAvXFxzKy8sXG4gICAgZGF0YUF0dHJQcmVmaXggPSAnZGF0YS0nLFxuICAgIF8gPSB7XG4gICAgICBmb3JFYWNoOiByZXF1aXJlKCdsb2Rhc2gvZm9yRWFjaCcpLFxuICAgICAgZXh0ZW5kOiByZXF1aXJlKCdsb2Rhc2gvYXNzaWduSW4nKSxcbiAgICAgIHNvbWU6IHJlcXVpcmUoJ2xvZGFzaC9zb21lJylcbiAgICB9LFxuXG4gIC8vIExvb2t1cCB0YWJsZSBmb3IgY29lcmNpbmcgc3RyaW5nIGRhdGEtKiBhdHRyaWJ1dGVzIHRvIHRoZWlyIGNvcnJlc3BvbmRpbmdcbiAgLy8gSmF2YVNjcmlwdCBwcmltaXRpdmVzXG4gIHByaW1pdGl2ZXMgPSB7XG4gICAgbnVsbDogbnVsbCxcbiAgICB0cnVlOiB0cnVlLFxuICAgIGZhbHNlOiBmYWxzZVxuICB9LFxuXG4gIC8vIEF0dHJpYnV0ZXMgdGhhdCBhcmUgYm9vbGVhbnNcbiAgcmJvb2xlYW4gPSAvXig/OmF1dG9mb2N1c3xhdXRvcGxheXxhc3luY3xjaGVja2VkfGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkfHNlbGVjdGVkKSQvaSxcbiAgLy8gTWF0Y2hlcyBzdHJpbmdzIHRoYXQgbG9vayBsaWtlIEpTT04gb2JqZWN0cyBvciBhcnJheXNcbiAgcmJyYWNlID0gL14oPzpcXHtbXFx3XFxXXSpcXH18XFxbW1xcd1xcV10qXFxdKSQvO1xuXG5cbnZhciBnZXRBdHRyID0gZnVuY3Rpb24oZWxlbSwgbmFtZSkge1xuICBpZiAoIWVsZW0gfHwgIWlzVGFnKGVsZW0pKSByZXR1cm47XG5cbiAgaWYgKCFlbGVtLmF0dHJpYnMpIHtcbiAgICBlbGVtLmF0dHJpYnMgPSB7fTtcbiAgfVxuXG4gIC8vIFJldHVybiB0aGUgZW50aXJlIGF0dHJpYnMgb2JqZWN0IGlmIG5vIGF0dHJpYnV0ZSBzcGVjaWZpZWRcbiAgaWYgKCFuYW1lKSB7XG4gICAgcmV0dXJuIGVsZW0uYXR0cmlicztcbiAgfVxuXG4gIGlmIChoYXNPd24uY2FsbChlbGVtLmF0dHJpYnMsIG5hbWUpKSB7XG4gICAgLy8gR2V0IHRoZSAoZGVjb2RlZCkgYXR0cmlidXRlXG4gICAgcmV0dXJuIHJib29sZWFuLnRlc3QobmFtZSkgPyBuYW1lIDogZWxlbS5hdHRyaWJzW25hbWVdO1xuICB9XG5cbiAgLy8gTWltaWMgdGhlIERPTSBhbmQgcmV0dXJuIHRleHQgY29udGVudCBhcyB2YWx1ZSBmb3IgYG9wdGlvbidzYFxuICBpZiAoZWxlbS5uYW1lID09PSAnb3B0aW9uJyAmJiBuYW1lID09PSAndmFsdWUnKSB7XG4gICAgcmV0dXJuICQudGV4dChlbGVtLmNoaWxkcmVuKTtcbiAgfVxuXG4gIC8vIE1pbWljIERPTSB3aXRoIGRlZmF1bHQgdmFsdWUgZm9yIHJhZGlvcy9jaGVja2JveGVzXG4gIGlmIChlbGVtLm5hbWUgPT09ICdpbnB1dCcgJiZcbiAgICAgIChlbGVtLmF0dHJpYnMudHlwZSA9PT0gJ3JhZGlvJyB8fCBlbGVtLmF0dHJpYnMudHlwZSA9PT0gJ2NoZWNrYm94JykgJiZcbiAgICAgIG5hbWUgPT09ICd2YWx1ZScpIHtcbiAgICByZXR1cm4gJ29uJztcbiAgfVxufTtcblxudmFyIHNldEF0dHIgPSBmdW5jdGlvbihlbCwgbmFtZSwgdmFsdWUpIHtcblxuICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICByZW1vdmVBdHRyaWJ1dGUoZWwsIG5hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsLmF0dHJpYnNbbmFtZV0gPSB2YWx1ZSsnJztcbiAgfVxufTtcblxuZXhwb3J0cy5hdHRyID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgLy8gU2V0IHRoZSB2YWx1ZSAod2l0aCBhdHRyIG1hcCBzdXBwb3J0KVxuICBpZiAodHlwZW9mIG5hbWUgPT09ICdvYmplY3QnIHx8IHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbCkge1xuICAgICAgICBzZXRBdHRyKGVsLCBuYW1lLCB2YWx1ZS5jYWxsKGVsLCBpLCBlbC5hdHRyaWJzW25hbWVdKSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGRvbUVhY2godGhpcywgZnVuY3Rpb24oaSwgZWwpIHtcbiAgICAgIGlmICghaXNUYWcoZWwpKSByZXR1cm47XG5cbiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgXy5mb3JFYWNoKG5hbWUsIGZ1bmN0aW9uKG9ialZhbHVlLCBvYmpOYW1lKSB7XG4gICAgICAgICAgc2V0QXR0cihlbCwgb2JqTmFtZSwgb2JqVmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldEF0dHIoZWwsIG5hbWUsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBnZXRBdHRyKHRoaXNbMF0sIG5hbWUpO1xufTtcblxudmFyIGdldFByb3AgPSBmdW5jdGlvbiAoZWwsIG5hbWUpIHtcbiAgaWYgKCFlbCB8fCAhaXNUYWcoZWwpKSByZXR1cm47XG5cbiAgcmV0dXJuIGhhc093bi5jYWxsKGVsLCBuYW1lKVxuICAgICAgPyBlbFtuYW1lXVxuICAgICAgOiByYm9vbGVhbi50ZXN0KG5hbWUpXG4gICAgICAgICAgPyBnZXRBdHRyKGVsLCBuYW1lKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgOiBnZXRBdHRyKGVsLCBuYW1lKTtcbn07XG5cbnZhciBzZXRQcm9wID0gZnVuY3Rpb24gKGVsLCBuYW1lLCB2YWx1ZSkge1xuICBlbFtuYW1lXSA9IHJib29sZWFuLnRlc3QobmFtZSkgPyAhIXZhbHVlIDogdmFsdWU7XG59O1xuXG5leHBvcnRzLnByb3AgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgdmFyIGkgPSAwLFxuICAgICAgcHJvcGVydHk7XG5cbiAgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJyAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG5cbiAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgIGNhc2UgJ3N0eWxlJzpcbiAgICAgICAgcHJvcGVydHkgPSB0aGlzLmNzcygpO1xuXG4gICAgICAgIF8uZm9yRWFjaChwcm9wZXJ0eSwgZnVuY3Rpb24gKHYsIHApIHtcbiAgICAgICAgICBwcm9wZXJ0eVtpKytdID0gcDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcHJvcGVydHkubGVuZ3RoID0gaTtcblxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3RhZ05hbWUnOlxuICAgICAgY2FzZSAnbm9kZU5hbWUnOlxuICAgICAgICBwcm9wZXJ0eSA9IHRoaXNbMF0ubmFtZS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHByb3BlcnR5ID0gZ2V0UHJvcCh0aGlzWzBdLCBuYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvcGVydHk7XG4gIH1cblxuICBpZiAodHlwZW9mIG5hbWUgPT09ICdvYmplY3QnIHx8IHZhbHVlICE9PSB1bmRlZmluZWQpIHtcblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKGosIGVsKSB7XG4gICAgICAgIHNldFByb3AoZWwsIG5hbWUsIHZhbHVlLmNhbGwoZWwsIGosIGdldFByb3AoZWwsIG5hbWUpKSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihfXywgZWwpIHtcbiAgICAgIGlmICghaXNUYWcoZWwpKSByZXR1cm47XG5cbiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHtcblxuICAgICAgICBfLmZvckVhY2gobmFtZSwgZnVuY3Rpb24odmFsLCBrZXkpIHtcbiAgICAgICAgICBzZXRQcm9wKGVsLCBrZXksIHZhbCk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRQcm9wKGVsLCBuYW1lLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfVxufTtcblxudmFyIHNldERhdGEgPSBmdW5jdGlvbihlbCwgbmFtZSwgdmFsdWUpIHtcbiAgaWYgKCFlbC5kYXRhKSB7XG4gICAgZWwuZGF0YSA9IHt9O1xuICB9XG5cbiAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0JykgcmV0dXJuIF8uZXh0ZW5kKGVsLmRhdGEsIG5hbWUpO1xuICBpZiAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICBlbC5kYXRhW25hbWVdID0gdmFsdWU7XG4gIH1cbn07XG5cbi8vIFJlYWQgdGhlIHNwZWNpZmllZCBhdHRyaWJ1dGUgZnJvbSB0aGUgZXF1aXZhbGVudCBIVE1MNSBgZGF0YS0qYCBhdHRyaWJ1dGUsXG4vLyBhbmQgKGlmIHByZXNlbnQpIGNhY2hlIHRoZSB2YWx1ZSBpbiB0aGUgbm9kZSdzIGludGVybmFsIGRhdGEgc3RvcmUuIElmIG5vXG4vLyBhdHRyaWJ1dGUgbmFtZSBpcyBzcGVjaWZpZWQsIHJlYWQgKmFsbCogSFRNTDUgYGRhdGEtKmAgYXR0cmlidXRlcyBpbiB0aGlzXG4vLyBtYW5uZXIuXG52YXIgcmVhZERhdGEgPSBmdW5jdGlvbihlbCwgbmFtZSkge1xuICB2YXIgcmVhZEFsbCA9IGFyZ3VtZW50cy5sZW5ndGggPT09IDE7XG4gIHZhciBkb21OYW1lcywgZG9tTmFtZSwganNOYW1lcywganNOYW1lLCB2YWx1ZSwgaWR4LCBsZW5ndGg7XG5cbiAgaWYgKHJlYWRBbGwpIHtcbiAgICBkb21OYW1lcyA9IE9iamVjdC5rZXlzKGVsLmF0dHJpYnMpLmZpbHRlcihmdW5jdGlvbihhdHRyTmFtZSkge1xuICAgICAgcmV0dXJuIGF0dHJOYW1lLnNsaWNlKDAsIGRhdGFBdHRyUHJlZml4Lmxlbmd0aCkgPT09IGRhdGFBdHRyUHJlZml4O1xuICAgIH0pO1xuICAgIGpzTmFtZXMgPSBkb21OYW1lcy5tYXAoZnVuY3Rpb24oX2RvbU5hbWUpIHtcbiAgICAgIHJldHVybiBjYW1lbENhc2UoX2RvbU5hbWUuc2xpY2UoZGF0YUF0dHJQcmVmaXgubGVuZ3RoKSk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgZG9tTmFtZXMgPSBbZGF0YUF0dHJQcmVmaXggKyBjc3NDYXNlKG5hbWUpXTtcbiAgICBqc05hbWVzID0gW25hbWVdO1xuICB9XG5cbiAgZm9yIChpZHggPSAwLCBsZW5ndGggPSBkb21OYW1lcy5sZW5ndGg7IGlkeCA8IGxlbmd0aDsgKytpZHgpIHtcbiAgICBkb21OYW1lID0gZG9tTmFtZXNbaWR4XTtcbiAgICBqc05hbWUgPSBqc05hbWVzW2lkeF07XG4gICAgaWYgKGhhc093bi5jYWxsKGVsLmF0dHJpYnMsIGRvbU5hbWUpKSB7XG4gICAgICB2YWx1ZSA9IGVsLmF0dHJpYnNbZG9tTmFtZV07XG5cbiAgICAgIGlmIChoYXNPd24uY2FsbChwcmltaXRpdmVzLCB2YWx1ZSkpIHtcbiAgICAgICAgdmFsdWUgPSBwcmltaXRpdmVzW3ZhbHVlXTtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IFN0cmluZyhOdW1iZXIodmFsdWUpKSkge1xuICAgICAgICB2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG4gICAgICB9IGVsc2UgaWYgKHJicmFjZS50ZXN0KHZhbHVlKSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhbHVlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgIH0gY2F0Y2goZSl7IH1cbiAgICAgIH1cblxuICAgICAgZWwuZGF0YVtqc05hbWVdID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlYWRBbGwgPyBlbC5kYXRhIDogdmFsdWU7XG59O1xuXG5leHBvcnRzLmRhdGEgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICB2YXIgZWxlbSA9IHRoaXNbMF07XG5cbiAgaWYgKCFlbGVtIHx8ICFpc1RhZyhlbGVtKSkgcmV0dXJuO1xuXG4gIGlmICghZWxlbS5kYXRhKSB7XG4gICAgZWxlbS5kYXRhID0ge307XG4gIH1cblxuICAvLyBSZXR1cm4gdGhlIGVudGlyZSBkYXRhIG9iamVjdCBpZiBubyBkYXRhIHNwZWNpZmllZFxuICBpZiAoIW5hbWUpIHtcbiAgICByZXR1cm4gcmVhZERhdGEoZWxlbSk7XG4gIH1cblxuICAvLyBTZXQgdGhlIHZhbHVlICh3aXRoIGF0dHIgbWFwIHN1cHBvcnQpXG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcgfHwgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGRvbUVhY2godGhpcywgZnVuY3Rpb24oaSwgZWwpIHtcbiAgICAgIHNldERhdGEoZWwsIG5hbWUsIHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfSBlbHNlIGlmIChoYXNPd24uY2FsbChlbGVtLmRhdGEsIG5hbWUpKSB7XG4gICAgcmV0dXJuIGVsZW0uZGF0YVtuYW1lXTtcbiAgfVxuXG4gIHJldHVybiByZWFkRGF0YShlbGVtLCBuYW1lKTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSB2YWx1ZSBvZiBhbiBlbGVtZW50XG4gKi9cblxuZXhwb3J0cy52YWwgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgcXVlcnlpbmcgPSBhcmd1bWVudHMubGVuZ3RoID09PSAwLFxuICAgICAgZWxlbWVudCA9IHRoaXNbMF07XG5cbiAgaWYoIWVsZW1lbnQpIHJldHVybjtcblxuICBzd2l0Y2ggKGVsZW1lbnQubmFtZSkge1xuICAgIGNhc2UgJ3RleHRhcmVhJzpcbiAgICAgIHJldHVybiB0aGlzLnRleHQodmFsdWUpO1xuICAgIGNhc2UgJ2lucHV0JzpcbiAgICAgIHN3aXRjaCAodGhpcy5hdHRyKCd0eXBlJykpIHtcbiAgICAgICAgY2FzZSAncmFkaW8nOlxuICAgICAgICAgIGlmIChxdWVyeWluZykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cigndmFsdWUnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hdHRyKCd2YWx1ZScsIHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyKCd2YWx1ZScsIHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgdmFyIG9wdGlvbiA9IHRoaXMuZmluZCgnb3B0aW9uOnNlbGVjdGVkJyksXG4gICAgICAgICAgcmV0dXJuVmFsdWU7XG4gICAgICBpZiAob3B0aW9uID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBpZiAoIXF1ZXJ5aW5nKSB7XG4gICAgICAgIGlmICghaGFzT3duLmNhbGwodGhpcy5hdHRyKCksICdtdWx0aXBsZScpICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT0gJ29iamVjdCcpIHtcbiAgICAgICAgICB2YWx1ZSA9IFt2YWx1ZV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maW5kKCdvcHRpb24nKS5yZW1vdmVBdHRyKCdzZWxlY3RlZCcpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdGhpcy5maW5kKCdvcHRpb25bdmFsdWU9XCInICsgdmFsdWVbaV0gKyAnXCJdJykuYXR0cignc2VsZWN0ZWQnLCAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICByZXR1cm5WYWx1ZSA9IG9wdGlvbi5hdHRyKCd2YWx1ZScpO1xuICAgICAgaWYgKGhhc093bi5jYWxsKHRoaXMuYXR0cigpLCAnbXVsdGlwbGUnKSkge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IFtdO1xuICAgICAgICBkb21FYWNoKG9wdGlvbiwgZnVuY3Rpb24oX18sIGVsKSB7XG4gICAgICAgICAgcmV0dXJuVmFsdWUucHVzaChnZXRBdHRyKGVsLCAndmFsdWUnKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICAgIGNhc2UgJ29wdGlvbic6XG4gICAgICBpZiAoIXF1ZXJ5aW5nKSB7XG4gICAgICAgIHRoaXMuYXR0cigndmFsdWUnLCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuYXR0cigndmFsdWUnKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZW1vdmUgYW4gYXR0cmlidXRlXG4gKi9cblxudmFyIHJlbW92ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uKGVsZW0sIG5hbWUpIHtcbiAgaWYgKCFlbGVtLmF0dHJpYnMgfHwgIWhhc093bi5jYWxsKGVsZW0uYXR0cmlicywgbmFtZSkpXG4gICAgcmV0dXJuO1xuXG4gIGRlbGV0ZSBlbGVtLmF0dHJpYnNbbmFtZV07XG59O1xuXG5cbmV4cG9ydHMucmVtb3ZlQXR0ciA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbGVtKSB7XG4gICAgcmVtb3ZlQXR0cmlidXRlKGVsZW0sIG5hbWUpO1xuICB9KTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbmV4cG9ydHMuaGFzQ2xhc3MgPSBmdW5jdGlvbihjbGFzc05hbWUpIHtcbiAgcmV0dXJuIF8uc29tZSh0aGlzLCBmdW5jdGlvbihlbGVtKSB7XG4gICAgdmFyIGF0dHJzID0gZWxlbS5hdHRyaWJzLFxuICAgICAgICBjbGF6eiA9IGF0dHJzICYmIGF0dHJzWydjbGFzcyddLFxuICAgICAgICBpZHggPSAtMSxcbiAgICAgICAgZW5kO1xuXG4gICAgaWYgKGNsYXp6ICYmIGNsYXNzTmFtZS5sZW5ndGgpIHtcbiAgICAgIHdoaWxlICgoaWR4ID0gY2xhenouaW5kZXhPZihjbGFzc05hbWUsIGlkeCsxKSkgPiAtMSkge1xuICAgICAgICBlbmQgPSBpZHggKyBjbGFzc05hbWUubGVuZ3RoO1xuXG4gICAgICAgIGlmICgoaWR4ID09PSAwIHx8IHJzcGFjZS50ZXN0KGNsYXp6W2lkeC0xXSkpXG4gICAgICAgICAgICAmJiAoZW5kID09PSBjbGF6ei5sZW5ndGggfHwgcnNwYWNlLnRlc3QoY2xhenpbZW5kXSkpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuZXhwb3J0cy5hZGRDbGFzcyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIC8vIFN1cHBvcnQgZnVuY3Rpb25zXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbCkge1xuICAgICAgdmFyIGNsYXNzTmFtZSA9IGVsLmF0dHJpYnNbJ2NsYXNzJ10gfHwgJyc7XG4gICAgICBleHBvcnRzLmFkZENsYXNzLmNhbGwoW2VsXSwgdmFsdWUuY2FsbChlbCwgaSwgY2xhc3NOYW1lKSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBSZXR1cm4gaWYgbm8gdmFsdWUgb3Igbm90IGEgc3RyaW5nIG9yIGZ1bmN0aW9uXG4gIGlmICghdmFsdWUgfHwgdHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykgcmV0dXJuIHRoaXM7XG5cbiAgdmFyIGNsYXNzTmFtZXMgPSB2YWx1ZS5zcGxpdChyc3BhY2UpLFxuICAgICAgbnVtRWxlbWVudHMgPSB0aGlzLmxlbmd0aDtcblxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtRWxlbWVudHM7IGkrKykge1xuICAgIC8vIElmIHNlbGVjdGVkIGVsZW1lbnQgaXNuJ3QgYSB0YWcsIG1vdmUgb25cbiAgICBpZiAoIWlzVGFnKHRoaXNbaV0pKSBjb250aW51ZTtcblxuICAgIC8vIElmIHdlIGRvbid0IGFscmVhZHkgaGF2ZSBjbGFzc2VzXG4gICAgdmFyIGNsYXNzTmFtZSA9IGdldEF0dHIodGhpc1tpXSwgJ2NsYXNzJyksXG4gICAgICAgIG51bUNsYXNzZXMsXG4gICAgICAgIHNldENsYXNzO1xuXG4gICAgaWYgKCFjbGFzc05hbWUpIHtcbiAgICAgIHNldEF0dHIodGhpc1tpXSwgJ2NsYXNzJywgY2xhc3NOYW1lcy5qb2luKCcgJykudHJpbSgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0Q2xhc3MgPSAnICcgKyBjbGFzc05hbWUgKyAnICc7XG4gICAgICBudW1DbGFzc2VzID0gY2xhc3NOYW1lcy5sZW5ndGg7XG5cbiAgICAgIC8vIENoZWNrIGlmIGNsYXNzIGFscmVhZHkgZXhpc3RzXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG51bUNsYXNzZXM7IGorKykge1xuICAgICAgICB2YXIgYXBwZW5kQ2xhc3MgPSBjbGFzc05hbWVzW2pdICsgJyAnO1xuICAgICAgICBpZiAoc2V0Q2xhc3MuaW5kZXhPZignICcgKyBhcHBlbmRDbGFzcykgPCAwKVxuICAgICAgICAgIHNldENsYXNzICs9IGFwcGVuZENsYXNzO1xuICAgICAgfVxuXG4gICAgICBzZXRBdHRyKHRoaXNbaV0sICdjbGFzcycsIHNldENsYXNzLnRyaW0oKSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG52YXIgc3BsaXRDbGFzcyA9IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICByZXR1cm4gY2xhc3NOYW1lID8gY2xhc3NOYW1lLnRyaW0oKS5zcGxpdChyc3BhY2UpIDogW107XG59O1xuXG5leHBvcnRzLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgdmFyIGNsYXNzZXMsXG4gICAgICBudW1DbGFzc2VzLFxuICAgICAgcmVtb3ZlQWxsO1xuXG4gIC8vIEhhbmRsZSBpZiB2YWx1ZSBpcyBhIGZ1bmN0aW9uXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gZG9tRWFjaCh0aGlzLCBmdW5jdGlvbihpLCBlbCkge1xuICAgICAgZXhwb3J0cy5yZW1vdmVDbGFzcy5jYWxsKFxuICAgICAgICBbZWxdLCB2YWx1ZS5jYWxsKGVsLCBpLCBlbC5hdHRyaWJzWydjbGFzcyddIHx8ICcnKVxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsYXNzZXMgPSBzcGxpdENsYXNzKHZhbHVlKTtcbiAgbnVtQ2xhc3NlcyA9IGNsYXNzZXMubGVuZ3RoO1xuICByZW1vdmVBbGwgPSBhcmd1bWVudHMubGVuZ3RoID09PSAwO1xuXG4gIHJldHVybiBkb21FYWNoKHRoaXMsIGZ1bmN0aW9uKGksIGVsKSB7XG4gICAgaWYgKCFpc1RhZyhlbCkpIHJldHVybjtcblxuICAgIGlmIChyZW1vdmVBbGwpIHtcbiAgICAgIC8vIFNob3J0IGNpcmN1aXQgdGhlIHJlbW92ZSBhbGwgY2FzZSBhcyB0aGlzIGlzIHRoZSBuaWNlIG9uZVxuICAgICAgZWwuYXR0cmlicy5jbGFzcyA9ICcnO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgZWxDbGFzc2VzID0gc3BsaXRDbGFzcyhlbC5hdHRyaWJzLmNsYXNzKSxcbiAgICAgICAgICBpbmRleCxcbiAgICAgICAgICBjaGFuZ2VkO1xuXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG51bUNsYXNzZXM7IGorKykge1xuICAgICAgICBpbmRleCA9IGVsQ2xhc3Nlcy5pbmRleE9mKGNsYXNzZXNbal0pO1xuXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgZWxDbGFzc2VzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG5cbiAgICAgICAgICAvLyBXZSBoYXZlIHRvIGRvIGFub3RoZXIgcGFzcyB0byBlbnN1cmUgdGhhdCB0aGVyZSBhcmUgbm90IGR1cGxpY2F0ZVxuICAgICAgICAgIC8vIGNsYXNzZXMgbGlzdGVkXG4gICAgICAgICAgai0tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICBlbC5hdHRyaWJzLmNsYXNzID0gZWxDbGFzc2VzLmpvaW4oJyAnKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuZXhwb3J0cy50b2dnbGVDbGFzcyA9IGZ1bmN0aW9uKHZhbHVlLCBzdGF0ZVZhbCkge1xuICAvLyBTdXBwb3J0IGZ1bmN0aW9uc1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIGRvbUVhY2godGhpcywgZnVuY3Rpb24oaSwgZWwpIHtcbiAgICAgIGV4cG9ydHMudG9nZ2xlQ2xhc3MuY2FsbChcbiAgICAgICAgW2VsXSxcbiAgICAgICAgdmFsdWUuY2FsbChlbCwgaSwgZWwuYXR0cmlic1snY2xhc3MnXSB8fCAnJywgc3RhdGVWYWwpLFxuICAgICAgICBzdGF0ZVZhbFxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFJldHVybiBpZiBubyB2YWx1ZSBvciBub3QgYSBzdHJpbmcgb3IgZnVuY3Rpb25cbiAgaWYgKCF2YWx1ZSB8fCB0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSByZXR1cm4gdGhpcztcblxuICB2YXIgY2xhc3NOYW1lcyA9IHZhbHVlLnNwbGl0KHJzcGFjZSksXG4gICAgbnVtQ2xhc3NlcyA9IGNsYXNzTmFtZXMubGVuZ3RoLFxuICAgIHN0YXRlID0gdHlwZW9mIHN0YXRlVmFsID09PSAnYm9vbGVhbicgPyBzdGF0ZVZhbCA/IDEgOiAtMSA6IDAsXG4gICAgbnVtRWxlbWVudHMgPSB0aGlzLmxlbmd0aCxcbiAgICBlbGVtZW50Q2xhc3NlcyxcbiAgICBpbmRleDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IG51bUVsZW1lbnRzOyBpKyspIHtcbiAgICAvLyBJZiBzZWxlY3RlZCBlbGVtZW50IGlzbid0IGEgdGFnLCBtb3ZlIG9uXG4gICAgaWYgKCFpc1RhZyh0aGlzW2ldKSkgY29udGludWU7XG5cbiAgICBlbGVtZW50Q2xhc3NlcyA9IHNwbGl0Q2xhc3ModGhpc1tpXS5hdHRyaWJzLmNsYXNzKTtcblxuICAgIC8vIENoZWNrIGlmIGNsYXNzIGFscmVhZHkgZXhpc3RzXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1DbGFzc2VzOyBqKyspIHtcbiAgICAgIC8vIENoZWNrIGlmIHRoZSBjbGFzcyBuYW1lIGlzIGN1cnJlbnRseSBkZWZpbmVkXG4gICAgICBpbmRleCA9IGVsZW1lbnRDbGFzc2VzLmluZGV4T2YoY2xhc3NOYW1lc1tqXSk7XG5cbiAgICAgIC8vIEFkZCBpZiBzdGF0ZVZhbHVlID09PSB0cnVlIG9yIHdlIGFyZSB0b2dnbGluZyBhbmQgdGhlcmUgaXMgbm8gdmFsdWVcbiAgICAgIGlmIChzdGF0ZSA+PSAwICYmIGluZGV4IDwgMCkge1xuICAgICAgICBlbGVtZW50Q2xhc3Nlcy5wdXNoKGNsYXNzTmFtZXNbal0pO1xuICAgICAgfSBlbHNlIGlmIChzdGF0ZSA8PSAwICYmIGluZGV4ID49IDApIHtcbiAgICAgICAgLy8gT3RoZXJ3aXNlIHJlbW92ZSBidXQgb25seSBpZiB0aGUgaXRlbSBleGlzdHNcbiAgICAgICAgZWxlbWVudENsYXNzZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzW2ldLmF0dHJpYnMuY2xhc3MgPSBlbGVtZW50Q2xhc3Nlcy5qb2luKCcgJyk7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbmV4cG9ydHMuaXMgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgaWYgKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHRoaXMuZmlsdGVyKHNlbGVjdG9yKS5sZW5ndGggPiAwO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG4iXX0=